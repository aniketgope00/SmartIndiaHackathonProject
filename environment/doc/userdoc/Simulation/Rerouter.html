<!--
MkDocs version : 1.5.2
Build Date UTC : 07 May 2024 06:14:12
Last edit: 06 May 2024
-->
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <meta property="og:image" content="../images/image-facebook.jpg">
        <meta property="og:image:type" content="image/jpeg">
        <meta property="og:image:width" content="1080">
        <meta property="og:image:height" content="1080">

        
        
        <link rel="canonical" href="https://sumo.dlr.de/docs/Simulation/Rerouter.html">
        <link rel="shortcut icon" href="../images/favicon.ico">
        <title>Rerouter - SUMO Documentation</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="apple-touch-icon" href="../images/apple-touch-icon.png">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../js/jquery-3.7.0.min.js" defer></script>
        <script src="../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 

      <script>
        // DARK MODE
        function detectColorScheme(){
          var theme="light";

          if(localStorage.getItem("sumo-docs-theme")){
              if(localStorage.getItem("sumo-docs-theme") == "dark"){
                  var theme = "dark";
              }
          } else if(!window.matchMedia) {
              return false;
          } else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
              var theme = "dark";
          }

          if (theme=="dark") {
              document.documentElement.setAttribute("data-theme", "dark");
          }
        }
        detectColorScheme();
      </script>

    </head>

    <body>

        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary text-center">
            <div class="container-fluid">
                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                </div>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../index.html" class="nav-link">Documentation</a>
                            </li>
                            <li class="navitem">
                                <a href="../Tutorials/index.html" class="nav-link">Tutorials</a>
                            </li>
                            <li class="navitem">
                                <a href="../FAQ.html" class="nav-link">FAQ</a>
                            </li>
                            <li class="navitem">
                                <a href="../Downloads.html" class="nav-link">Downloads</a>
                            </li>
                            <li class="navitem">
                                <a href="../Publications.html" class="nav-link">Publications</a>
                            </li>
                            <li class="navitem">
                                <a href="../Developer/index.html" class="nav-link">Developer</a>
                            </li>
                            <li class="navitem">
                                <a href="../ChangeLog.html" class="nav-link">ChangeLog</a>
                            </li>
                            <li class="navitem">
                                <a href="https://eclipse.dev/sumo/contact/" class="nav-link">Contact</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa-solid fa-magnifying-glass"></i> <u>S</u>earch
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="edit" href="https://github.com/eclipse-sumo/sumo/edit/main/docs/web/docs/Simulation/Rerouter.md" class="nav-link"><i class="fa-brands fa-github"></i> <u>E</u>dit on GitHub</a>
                            </li>
                      <li class="nav-item dropdown">
                          <a class="nav-link dropdown-toggle" href="#" id="navbardrop" data-toggle="dropdown">
                            More <i class="fa-solid fa-circle-chevron-down"></i>
                          </a>
                          <div class="dropdown-menu dropdown-menu-right">
                            <a class="dropdown-item no-arrow-link" href="https://github.com/eclipse/sumo/issues">Report a Bug / Issue / Typo</a>
                            <a class="dropdown-item" href="../Editing_Articles.html">Help on editing articles</a>
                            <a class="dropdown-item" href="https://github.com/eclipse/sumo/commits/main/docs/web">Recent documentation changes</a>
                            <a class="dropdown-item" href="#" data-toggle="modal" data-target="#mkdocs_keyboard_modal">Keyboard Shortcuts</a>
                            <a class="dropdown-item no-arrow-link" href="https://sumo.dlr.de/sumo_documentation.zip">Download the Documentation</a>
                            <span class="dropdown-item" id="dark-mode-div">Dark mode <label id="theme-switch" class="theme-switch" for="checkbox_theme">
                              <input type="checkbox" id="checkbox_theme">
                          </label></span>
                          </div>
                        </li>
                        <li class="nav-item dropdown">
                          <a class="nav-link dropdown-toggle" href="#" id="languagedrop" data-toggle="dropdown">
                            <i class="fa-solid fa-language"></i> Languages <i class="fa-solid fa-circle-chevron-down"></i>
                          </a>
                          <div class="dropdown-menu dropdown-menu-right">
                            <span class="dropdown-item">
                              Translations are generated automatically by Google Translate:
                            </span>
                            <a class="dropdown-item" href="https://sumo-dlr-de.translate.goog/docs/Simulation/Rerouter.html?_x_tr_sl=en&_x_tr_tl=de">Deutsch</a>
                            <a class="dropdown-item" href="https://sumo-dlr-de.translate.goog/docs/Simulation/Rerouter.html?_x_tr_sl=en&_x_tr_tl=es">Español</a>
                            <a class="dropdown-item" href="https://sumo-dlr-de.translate.goog/docs/Simulation/Rerouter.html?_x_tr_sl=en&_x_tr_tl=fr">Français</a>
                            <a class="dropdown-item" href="https://sumo-dlr-de.translate.goog/docs/Simulation/Rerouter.html?_x_tr_sl=en&_x_tr_tl=it">Italiano</a>
                            <a class="dropdown-item" href="https://sumo-dlr-de.translate.goog/docs/Simulation/Rerouter.html?_x_tr_sl=en&_x_tr_tl=hu">Magyar</a>
                            <a class="dropdown-item" href="https://sumo-dlr-de.translate.goog/docs/Simulation/Rerouter.html?_x_tr_sl=en&_x_tr_tl=tr">Türkçe</a>
                          </div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container-fluid">
          <div class="row">
                <div class="col-md-3">
                  <div class="text-center"><a href="../index.html" style="display: inline-block; margin-top: 5px;"><img src="../images/sumo-logo.png" class="sumoLogo" alt="SUMO Logo" width="120px"></a></div>
                  
<div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Contents">
            <span class="fa-solid fa-angle-down"></span>
        </button>
    </div>
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary toc-scroll toc">
        <ul class="nav flex-column bs-sidenav">
            <p style="margin-top:5px; color:#777777;" class="text-center">Contents</p>
            <li class="nav-item main"><a href="#rerouter">Rerouter</a></li>
                <li class="nav-item" style="text-indent: 5px;">
                    <a href="#definition_styles" class="nav-link">• Definition styles</a>
                </li>
                <li class="nav-item" style="text-indent: 25px;">
                    <a href="#everything_in_one_file" class="nav-link">&rarr; everything in one file</a>
                </li>
                <li class="nav-item" style="text-indent: 25px;">
                    <a href="#definitions_in_a_separate_file" class="nav-link">&rarr; definitions in a separate file</a>
                </li>
                <li class="nav-item" style="text-indent: 5px;">
                    <a href="#closing_a_street" class="nav-link">• Closing a Street</a>
                </li>
                <li class="nav-item" style="text-indent: 5px;">
                    <a href="#closing_a_lane" class="nav-link">• Closing a Lane</a>
                </li>
                <li class="nav-item" style="text-indent: 25px;">
                    <a href="#reversible_lanes" class="nav-link">&rarr; Reversible Lanes</a>
                </li>
                <li class="nav-item" style="text-indent: 5px;">
                    <a href="#assigning_a_new_destination" class="nav-link">• Assigning a new Destination</a>
                </li>
                <li class="nav-item" style="text-indent: 25px;">
                    <a href="#special_destination_values" class="nav-link">&rarr; Special Destination Values</a>
                </li>
                <li class="nav-item" style="text-indent: 5px;">
                    <a href="#assigning_a_new_route" class="nav-link">• Assigning a new Route</a>
                </li>
                <li class="nav-item" style="text-indent: 25px;">
                    <a href="#repeated_public_transport_routes" class="nav-link">&rarr; Repeated public transport routes</a>
                </li>
                <li class="nav-item" style="text-indent: 5px;">
                    <a href="#rerouting_to_an_alternative_parking_area" class="nav-link">• Rerouting to an alternative Parking Area</a>
                </li>
                <li class="nav-item" style="text-indent: 25px;">
                    <a href="#memory_in_parking_search" class="nav-link">&rarr; Memory in parking search</a>
                </li>
                <li class="nav-item" style="text-indent: 25px;">
                    <a href="#determining_the_alternative_parking_area" class="nav-link">&rarr; Determining the alternative parking area</a>
                </li>
                <li class="nav-item" style="text-indent: 25px;">
                    <a href="#further_parameters_to_affect_parking_behavior" class="nav-link">&rarr; Further parameters to affect parking behavior</a>
                </li>
                <li class="nav-item" style="text-indent: 25px;">
                    <a href="#destination_after_rerouting" class="nav-link">&rarr; Destination after rerouting</a>
                </li>
                <li class="nav-item" style="text-indent: 25px;">
                    <a href="#traci_access_to_parkingsearch" class="nav-link">&rarr; TraCI access to parkingSearch</a>
                </li>
            <li class="nav-item main"><a href="#vehicle_behavior_when_closing_a_street">Vehicle Behavior when closing a street</a></li>
                <li class="nav-item" style="text-indent: 5px;">
                    <a href="#hard_closing" class="nav-link">• Hard closing</a>
                </li>
                <li class="nav-item" style="text-indent: 5px;">
                    <a href="#soft_closing" class="nav-link">• Soft closing</a>
                </li>
                <li class="nav-item" style="text-indent: 5px;">
                    <a href="#departure_on_a_closed_edge" class="nav-link">• Departure on a closed edge</a>
                </li>
        </ul>
    </div>

    <div class="admonition conference" style="position: sticky; margin-top: 20px; margin-bottom:10px;">
        <p>visit <a class="no-arrow-link" href="https://eclipse.dev/sumo">eclipse.dev/sumo</a></p>
    </div>

</div>
                </div>
                <div class="col-md-9 main-area" role="main">
                   <!-- page.is_homepage seems to be broken in Mkdocs > 1.1.0 -->
                  <ul class="breadcrumbs">
    <script>
        var pagePath = "/docs/Simulation/Rerouter.html";
        var splitUrl = pagePath.split("/");
        splitUrl.pop();
        splitUrl.shift();
        if (splitUrl[0] == 'docs') splitUrl.shift();
        var homeLink = "../index.html";
        document.write('<li class="breadcrumb-item"><a href="' + homeLink + '"><i class="fa-solid fa-house"></i></a></li>');
        var prev = '';

        var dirLink = splitUrl.map(function (el) {
        el = prev + el; prev = el + '/'; return el;
        });

        for (let i = 0; i < splitUrl.length; i++) {
            document.write("<li class=\"breadcrumb-item\"><a class=\"no-arrow-link\" href=\"../" + dirLink[i] + "\">" + splitUrl[i] + "</a></li>");
        }
    </script>
    <li class="breadcrumb-item active">Rerouter</li>
</ul>
                  <hTitles>Rerouter<hr style="border: 0.5px solid #338033; margin-top: 5px !important;"></hTitles>
                  
                  

<h1 id="rerouter">Rerouter<a class="headerlink" href="#rerouter" title="Permanent link">#</a></h1>
<p>Rerouter changes the route of a vehicle as soon as the vehicle moves
onto a specified edge.</p>
<p>A rerouter is set into the simulated network by adding the following
declaration line to an <a href="/docs/sumo.html#format_of_additional_files"><em>additional-file</em></a>: <code>&lt;rerouter id="&lt;REROUTER_ID&gt;" edges="&lt;EDGE_ID&gt;[;&lt;EDGE_ID&gt;]*" file="&lt;DEFINITION_FILE&gt;" [probability="&lt;PROBABILITY&gt;"]/&gt;</code>.
Rerouter may be placed on several edges, at least one edge is necessary.
Furthermore, it is possible to define the probability for rerouting a
vehicle by giving a number between 0 (none) and 1 (all) already within
the definition. The declaration values are:</p>
<table>
<thead>
<tr>
<th>Attribute Name</th>
<th>Value Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>id</strong></td>
<td>id (string)</td>
<td>The id of of the rerouter</td>
</tr>
<tr>
<td><strong>edges</strong></td>
<td>float</td>
<td>An edge id or a list of edge ids where vehicles shall be rerouted</td>
</tr>
<tr>
<td>probability</td>
<td>float</td>
<td>The probability for vehicle rerouting (0-1), default 1</td>
</tr>
<tr>
<td>timeThreshold</td>
<td>time (s)</td>
<td>minimum accumulated waiting time before the rerouter takes effect (default 0 applies always)</td>
</tr>
<tr>
<td>vTypes</td>
<td>stringList</td>
<td>Space-separated list of vType IDs for which this rerouter should apply (default "" applies to all)</td>
</tr>
<tr>
<td>off</td>
<td>bool</td>
<td>Whether the router should be inactive initially (and switched on in the gui), <em>default:false</em></td>
</tr>
</tbody>
</table>
<p>A rerouter may work in several different ways. Within a time period you
may close an edge, or assign new destinations or predefined routes to
vehicles. The next sections will describe these actions in detail.</p>
<h2 id="definition_styles">Definition styles<a class="headerlink" href="#definition_styles" title="Permanent link">#</a></h2>
<p>There are two styles in which to declare rerouters.</p>
<h3 id="everything_in_one_file">everything in one file<a class="headerlink" href="#everything_in_one_file" title="Permanent link">#</a></h3>
<p>The <a href="/docs/sumo.html#format_of_additional_files"><em>additional-file</em></a> looks like this:</p>
<pre class="codehilite"><code class="language-xml">&lt;additional&gt;
   &lt;rerouter id=&quot;&lt;REROUTER_ID&gt;&quot; edges=&quot;&lt;EDGE_ID&gt;[;&lt;EDGE_ID&gt;]*&quot; [probability=&quot;&lt;PROBABILITY&gt;&quot;]&gt;
      &lt;interval begin=&quot;&lt;BEGIN_TIME&gt;&quot; end=&quot;&lt;END_TIME&gt;&quot;&gt;
         ... action description ...
      &lt;/interval&gt;

      ... further intervals ...
   &lt;/rerouter&gt;

   ... further rerouters ...
&lt;/additional&gt;
</code></pre>

<h3 id="definitions_in_a_separate_file">definitions in a separate file<a class="headerlink" href="#definitions_in_a_separate_file" title="Permanent link">#</a></h3>
<p>The <a href="/docs/sumo.html#format_of_additional_files"><em>additional-file</em></a> looks like this:</p>
<pre class="codehilite"><code class="language-xml">&lt;additional&gt;
   &lt;rerouter id=&quot;&lt;REROUTER_ID&gt;&quot; edges=&quot;&lt;EDGE_ID&gt;[;&lt;EDGE_ID&gt;]*&quot; [probability=&quot;&lt;PROBABILITY&gt;&quot;]&gt;
     &lt;include href=&quot;definitions.xml&quot;/&gt;
   &lt;/rerouter&gt;

   ... further rerouters ...
&lt;/additional&gt;
</code></pre>

<p>And the file <code>definitions.xml</code> (which describes the actions over time) looks
like this:</p>
<pre class="codehilite"><code class="language-xml">   &lt;interval begin=&quot;&lt;BEGIN_TIME&gt;&quot; end=&quot;&lt;END_TIME&gt;&quot;&gt;
      ... action description ...
   &lt;/interval&gt;

   ... further intervals ...
</code></pre>

<p>Note, that the definition file has no root-level element</p>
<p>All the following examples use the <a href="#everything_in_one_file">everything-in-one-file</a>-syntax.</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Support for rerouter attribute <code>file</code> to include additional definitions was removed in version 1.13.0</p>
</div>
<h2 id="closing_a_street">Closing a Street<a class="headerlink" href="#closing_a_street" title="Permanent link">#</a></h2>
<p>A "closingReroute" forces the rerouter to close the edge &lt;EDGE_ID&gt;.
Vehicles which normally would pass this edge will get a new route as
soon as they reach one of the edges given in the edges-attribute of the
rerouter's declaration. The algorithm for selecting a new route is the
same as described at
<a href="#assigning_a_new_destination">#Assigning_a_new_Destination</a>
with the additional constraint that closed edges must be avoided. A
closingReroute definition may look like this:</p>
<pre class="codehilite"><code class="language-xml">&lt;rerouter&gt;
   &lt;interval begin=&quot;&lt;BEGIN_TIME&gt;&quot; end=&quot;&lt;END_TIME&gt;&quot;&gt;
      &lt;closingReroute id=&quot;&lt;EDGE_ID&gt;&quot;/&gt;
   &lt;/interval&gt;

   ... further intervals ...

&lt;/rerouter&gt;
</code></pre>

<p>The attributes used within such definitions are:</p>
<table>
<thead>
<tr>
<th>Attribute Name</th>
<th>Value Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>id</strong></td>
<td>id (string)</td>
<td>The id of the closed edge; the id must be the id of an edge within the network</td>
</tr>
<tr>
<td>allow</td>
<td>list of vehicle classes</td>
<td>The (optional) ' '-separated list of <a href="../Definition_of_Vehicles%2C_Vehicle_Types%2C_and_Routes.html#abstract_vehicle_class">vehicle classes</a> which are still allowed to drive on the closed edge. All others are forbidden.</td>
</tr>
<tr>
<td>disallow</td>
<td>list of vehicle classes</td>
<td>The (optional) ' '-separated list of <a href="../Definition_of_Vehicles%2C_Vehicle_Types%2C_and_Routes.html#abstract_vehicle_class">vehicle classes</a> which are forbidden from driving on the closed edge. All others are allowed.</td>
</tr>
</tbody>
</table>
<p>When using a <code>&lt;closingReroute&gt;</code> without attributes <code>allow</code> and <code>disallow</code>, vehicles that cannot reach their
destination by an alternative route simply continue on their old route
and will effectively ignore the closing of the edges. When using either
attribute <code>allow</code> or <code>disallow</code> (only one may be used in the same definition), vehicles
which cannot change their route will stop in front of the closed edge
until the defined interval ends. This may be used to simulate traffic
jams, caused by spontaneous road closing.</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>When using modified permissions, it may be necessary to use the option <strong>--ignore-route-errors</strong> as vehicles which are inserted while the closing is active may raise a route error otherwise. Furthermore, permissions may cause emergency braking. This can be mitigated by placing <a href="Variable_Speed_Signs.html">VariableSpeedSigns</a> ahead of the closing and slowing down traffic briefly before the closing.</p>
</div>
<h2 id="closing_a_lane">Closing a Lane<a class="headerlink" href="#closing_a_lane" title="Permanent link">#</a></h2>
<p>A "closingLaneReroute" forces the rerouter to close the lane &lt;LANE_ID&gt;
by setting its permissions to <em>authority</em> (this can be customized).
Vehicles that pass this route and which are equipped with a <a href="../Demand/Automatic_Routing.html">rerouting
device</a> may compute a new route as
soon as they reach one of the edges given in the edges-attribute of the
rerouter's declaration. A closingLaneReroute definition may look like
this:</p>
<pre class="codehilite"><code class="language-xml">&lt;rerouter&gt;
   &lt;interval begin=&quot;&lt;BEGIN_TIME&gt;&quot; end=&quot;&lt;END_TIME&gt;&quot;&gt;
      &lt;closingLaneReroute id=&quot;&lt;LANE_ID&gt;&quot;/&gt;
   &lt;/interval&gt;

   ... further intervals ...

&lt;/rerouter&gt;
</code></pre>

<p>The attributes used within such definitions are:</p>
<table>
<thead>
<tr>
<th>Attribute Name</th>
<th>Value Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>id</strong></td>
<td>id (string)</td>
<td>The id of the closed lane; the id must be the id of a lane within the network</td>
</tr>
<tr>
<td>allow</td>
<td>list of vehicle classes</td>
<td>The (optional) ' '-separated list of <a href="../Definition_of_Vehicles%2C_Vehicle_Types%2C_and_Routes.html#abstract_vehicle_class">vehicle classes</a> which are still allowed to drive on the closed edge. All others are forbidden. (default <em>authority</em>)</td>
</tr>
<tr>
<td>disallow</td>
<td>list of vehicle classes</td>
<td>The (optional) ' '-separated list of <a href="../Definition_of_Vehicles%2C_Vehicle_Types%2C_and_Routes.html#abstract_vehicle_class">vehicle classes</a> which are forbidden from driving on the closed edge. All others are allowed. (This attribute may be used instead of <strong>allow</strong> for brevity if only a few classes shall be disallowed).</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Modified permissions may cause emergency braking. This can be mitigated by placing <a href="Variable_Speed_Signs.html">VariableSpeedSigns</a> ahead of the closing and slowing down traffic briefly before the closing.</p>
</div>
<h3 id="reversible_lanes">Reversible Lanes<a class="headerlink" href="#reversible_lanes" title="Permanent link">#</a></h3>
<p>Two <code>closingLaneReroute</code> definitions may be used to simulate a reversible lane in the following way:</p>
<ul>
<li>Define two edges in reverse directions with at least 2 lanes each</li>
<li><a href="../Netedit/editModesCommon.html#inspecting_lanes">prohibit driving on one of the central lanes</a> (disallow="all")</li>
<li>and modify the edge geometry so that the central lanes occupy the same space.<ul>
<li>by shifting geometry of <a href="../Netedit/editModesCommon.html#frame_operation">both edges sideways (-1.6 for default lane width)</a></li>
<li>or by <a href="../Netedit/neteditUsageExamples.html#specifying_the_complete_geometry_of_an_edge_including_endpoints">setting the geometry directly</a></li>
</ul>
</li>
</ul>
<p>To change their direction for a specific duration, the following rerouter may be used:</p>
<pre class="codehilite"><code class="language-xml">&lt;rerouter id=&quot;example&quot; edges=&quot;E1 -E1&quot;&gt;
      &lt;interval begin=&quot;7:0:0&quot; end=&quot;8:30:0&quot;&gt;
            &lt;closingLaneReroute id=&quot;E1_1&quot; allow=&quot;all&quot;/&gt;
            &lt;closingLaneReroute id=&quot;-E1_1&quot; disallow=&quot;all&quot;/&gt;
      &lt;/interval&gt;

   &lt;/rerouter&gt;
</code></pre>

<p>Alternatively to changing lane permissions with a rerouter, the traci functions <a href="../TraCI/Change_Lane_State.html"><code>traci.lane.setAllowed</code> and <code>setDisallowed</code></a> may also be used.</p>
<h2 id="assigning_a_new_destination">Assigning a new Destination<a class="headerlink" href="#assigning_a_new_destination" title="Permanent link">#</a></h2>
<p>A "destProbReroute" forces the rerouter to assign a new route to
vehicles that pass one of the edges defined in the edges-attribute of
the rerouter's declaration. A new route destination is used, defined by
the name of a new destination in the according element:</p>
<pre class="codehilite"><code class="language-xml">&lt;rerouter&gt;
   &lt;interval begin=&quot;&lt;BEGIN_TIME&gt;&quot; end=&quot;&lt;END_TIME&gt;&quot;&gt;
      &lt;destProbReroute id=&quot;&lt;EDGE_ID1&gt;&quot; probability=&quot;&lt;PROBABILITY1&gt;&quot;/&gt;
      &lt;destProbReroute id=&quot;&lt;EDGE_ID2&gt;&quot; probability=&quot;&lt;PROBABILITY2&gt;&quot;/&gt;
   &lt;/interval&gt;

   ... further intervals ...

&lt;/rerouter&gt;
</code></pre>

<p>The fastest route is computed automatically using the Dijkstra-algorithm
and starting at the edge the vehicle is located at and ending at the new
destination. The following travel times are considered for routing (the
first applicable value is used):</p>
<ul>
<li>the current (smoothed) travel times in the network are used if the
   vehicle is equipped with a <a href="../Demand/Automatic_Routing.html">rerouting
   device</a></li>
<li>subjective edge costs for the current vehicle if set via <a href="../TraCI/Change_Vehicle_State.html#change_edge_travel_time_information_0x58">TraCI
   command <em>change edge travel time
   information</em></a></li>
<li>edge weights loaded via the <a href="../sumo.html">sumo</a> option <strong>--weight-files</strong></li>
<li>travel times in the empty network</li>
</ul>
<p>The attributes used within a destProbReroute are:</p>
<table>
<thead>
<tr>
<th>Attribute Name</th>
<th>Value Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>id</strong></td>
<td>id (string)</td>
<td>The id of the new destination; the id must be the id of an edge within the network or one of the special values <em>keepDestination</em>, <em>terminateRoute</em></td>
</tr>
<tr>
<td><strong>probability</strong></td>
<td>float (should be between 0 and 1)</td>
<td>The probability with which a vehicle will use the given edge as destination; the probabilities are automatically normalized to sum to 1</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is possible to combine <strong>closingReroute</strong> and <strong>destProbReroute</strong> within the same interval. In this case, only vehicles which cannot reach their original destination draw new destinations from the probability distribution.</p>
</div>
<h3 id="special_destination_values">Special Destination Values<a class="headerlink" href="#special_destination_values" title="Permanent link">#</a></h3>
<ul>
<li><em>keepDestination</em>: the vehicle continues on its current route</li>
<li><em>terminateRoute</em>: the vehicle immediately leaves the simulation and
   counts as arrived at its current position on the rerouter edge</li>
</ul>
<h2 id="assigning_a_new_route">Assigning a new Route<a class="headerlink" href="#assigning_a_new_route" title="Permanent link">#</a></h2>
<p>A "routeProbReroute" forces the rerouter to assign a new route to
vehicles which pass one of the edges defined in the edges-attribute of
the rerouter's declaration. In this case, the id of a complete route
must be supplied instead of a new destination:</p>
<pre class="codehilite"><code class="language-xml">&lt;rerouter&gt;
   &lt;interval begin=&quot;&lt;BEGIN_TIME&gt;&quot; end=&quot;&lt;END_TIME&gt;&quot;&gt;
      &lt;routeProbReroute id=&quot;&lt;ROUTE_ID1&gt;&quot; probability=&quot;&lt;PROBABILITY1&gt;&quot;/&gt;
      &lt;routeProbReroute id=&quot;&lt;ROUTE_ID2&gt;&quot; probability=&quot;&lt;PROBABILITY2&gt;&quot;/&gt;
   &lt;/interval&gt;

   ... further intervals ...

&lt;/rerouter&gt;
</code></pre>

<p>The attributes used within such definitions are:</p>
<table>
<thead>
<tr>
<th>Attribute Name</th>
<th>Value Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>id</strong></td>
<td>id (string)</td>
<td>The id of a new route to assign; the id must be the id of a previously loaded route</td>
</tr>
<tr>
<td>probability</td>
<td>float</td>
<td>The the probability with which a vehicle will use the given edge as destination; (default 1). The probabilities are automatically normalized for all entries</td>
</tr>
</tbody>
</table>
<h3 id="repeated_public_transport_routes">Repeated public transport routes<a class="headerlink" href="#repeated_public_transport_routes" title="Permanent link">#</a></h3>
<p>If the new route assigned with the rerouter contains stops, the vehicle will use these stops. If the stops use attribute 'until' then the route should use attribute <a href="../Definition_of_Vehicles%2C_Vehicle_Types%2C_and_Routes.html#repeated_routes">'cycleTime'</a> to shift the until-times by a set amount on each repeat.</p>
<h2 id="rerouting_to_an_alternative_parking_area">Rerouting to an alternative Parking Area<a class="headerlink" href="#rerouting_to_an_alternative_parking_area" title="Permanent link">#</a></h2>
<p>Vehicles that stop at a <a href="ParkingArea.html">parking
area</a> may encounter the situation
that the parking area has reached the limit of its capacity and does not
permit parking.</p>
<p>In this case the vehicle either waits on the road until a parking space
becomes available or it may reroute to an alternative parking area. For
the latter behavior a <code>parkingAreaReroute</code>-definition must be specified. This rerouter
definition defines a set of parking areas that may be mutually used as
alternatives. Rerouting to another parking area is triggered in two
cases:</p>
<ul>
<li>when a vehicle reaches a parkingArea and is unable to stop due to
   lack of capacity</li>
<li>when a vehicle enters one of the rerouter-edges and the following
   conditions are all met:<ul>
<li>its current destination parkingArea is among the set of
    parkingAreaReroute definitions and has attribute <code>visible="true"</code></li>
<li>its current destination parkingArea is full</li>
</ul>
</li>
</ul>
<p>The definition looks like this:</p>
<pre class="codehilite"><code class="language-xml">   &lt;rerouter id=&quot;myRerouter&quot; edges=&quot;a b&quot;&gt;
      &lt;interval begin=&quot;0&quot; end=&quot;2000&quot;&gt;
         &lt;parkingAreaReroute id=&quot;ParkAreaA&quot;/&gt;
         &lt;parkingAreaReroute id=&quot;ParkAreaB&quot;/&gt;
      &lt;/interval&gt;
   &lt;/rerouter&gt;
</code></pre>

<p>The attributes used within such definitions are:</p>
<table>
<thead>
<tr>
<th>Attribute Name</th>
<th>Value Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>id</strong></td>
<td>id (string)</td>
<td>The id of an existing parking area</td>
</tr>
<tr>
<td>probability</td>
<td>float</td>
<td>The probability for each of the alternatives to be selected (default 1).</td>
</tr>
<tr>
<td>visible</td>
<td>bool</td>
<td>Whether occupancy of this parkingArea is known before reaching the parkingArea edge (this models line-of-sight as well as parking information systems).</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code>&lt;parkingAreaReroute&gt;</code> definitions to model parking search can be automatically generated with the tool <a href="../Tools/Misc.html#generateparkingarearerouterspy">generateParkingAreaRerouters.py</a></p>
</div>
<h3 id="memory_in_parking_search">Memory in parking search<a class="headerlink" href="#memory_in_parking_search" title="Permanent link">#</a></h3>
<p>Parking search refers to the situation where a vehicle encounters an occupied parkingArea and has to pick among a list of alternative destinations without knowing their occupancy state. The vehicle has to iteratively drive to alternative destinations until a free parking space is found. ParkingAreas that were visited earlier (and occupied) might be reasonably visited again with the expectation that they have cleared up since the last visit. By default, vehicles will not visit an occupied parkingArea again for 600s. This can be modified with vehicle-param or vType-param as follows:</p>
<pre class="codehilite"><code class="language-xml">   &lt;vehicle ...&gt;
      &lt;param key=&quot;parking.memory&quot; value=&quot;300&quot;/&gt;
   &lt;/vehicle
</code></pre>

<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Up to version 1.10.0 parking memory was 0 which could cause vehicles to visit only a small set of areas repeatedly.</p>
</div>
<h3 id="determining_the_alternative_parking_area">Determining the alternative parking area<a class="headerlink" href="#determining_the_alternative_parking_area" title="Permanent link">#</a></h3>
<p>The alternative parkingArea will be selected among all parking areas
that are visible and have at least 1 free space according to the minimum
weighted sum over a number of attributes. For invisible parkingAreas
(attribute <code>visible="false"</code>, the occupancy value is a taken as a random number from
[0,capacity[ which means they are always among the set of alternatives
even when full. Each attribute (i.e. occupancy, time, distance) is normalized to [0-1] with the maximum value of all candidate parkingAreas with positive remaining capacity) and inverted as necessary.</p>
<p>By default only the distance from the current vehicle
position to the new parking area is considered. The following table
describes the weighting factors that can be customized using <a href="GenericParameters.html">generic
parameters of the vehicle or its
vType</a>:</p>
<table>
<thead>
<tr>
<th>Parameter Name</th>
<th>Default value</th>
<th>Description</th>
<th>Inverse (Bigger is better)</th>
</tr>
</thead>
<tbody>
<tr>
<td>parking.probability.weight</td>
<td>0</td>
<td>the influence of the <em>probability</em> attribute of the <code>parkingAreaReroute</code></td>
<td>yes</td>
</tr>
<tr>
<td>parking.capacity.weight</td>
<td>0</td>
<td>The total capacity of the parking area</td>
<td>yes</td>
</tr>
<tr>
<td>parking.absfreespace.weight</td>
<td>0</td>
<td>The absolute number of free spaces</td>
<td>yes</td>
</tr>
<tr>
<td>parking.relfreespace.weight</td>
<td>0</td>
<td>The relative number of free spaces</td>
<td>yes</td>
</tr>
<tr>
<td>parking.distanceto.weight</td>
<td>1</td>
<td>The road distance to the parking area</td>
<td>no</td>
</tr>
<tr>
<td>parking.timeto.weight</td>
<td>0</td>
<td>The assumed travel time to the parking area</td>
<td>no</td>
</tr>
<tr>
<td>parking.distancefrom.weight</td>
<td>0</td>
<td>The road distance from the parking area to the vehicles destination</td>
<td>no</td>
</tr>
<tr>
<td>parking.timefrom.weight</td>
<td>0</td>
<td>The assumed travel time from the parking area to the vehicle destination</td>
<td>no</td>
</tr>
</tbody>
</table>
<p>When 'parking.probability.weight' is set to a positive value, a random number between 0 and attribute 'probability' is drawn for each candidate parkingArea. This value is then normalized to the range [0,1] by dividing with the maximum probability value of all parkingAreaReroute elements. The negative normalized value is then multiplied with parking.probability.weight to enter into the candidate score.</p>
<h3 id="further_parameters_to_affect_parking_behavior">Further parameters to affect parking behavior<a class="headerlink" href="#further_parameters_to_affect_parking_behavior" title="Permanent link">#</a></h3>
<table>
<thead>
<tr>
<th>Parameter Name</th>
<th>Default value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>parking.anywhere</td>
<td>-1</td>
<td>permit using any free parkingArea along the way after doing unsuccessful parkingAreaReroute x times (-1 disables this behavior)</td>
</tr>
<tr>
<td>parking.frustration</td>
<td>100</td>
<td>increases the preference for visibly free parkingAreas over time (after x unsuccessful parkingAreaReroutes, targets with unknown occupancy will assumed to be <em>almost</em> full)</td>
</tr>
<tr>
<td>parking.knowledge</td>
<td>0</td>
<td>Let driver "guess" the exact occupancy of invisible parkingAreas with probability x</td>
</tr>
</tbody>
</table>
<h3 id="destination_after_rerouting">Destination after rerouting<a class="headerlink" href="#destination_after_rerouting" title="Permanent link">#</a></h3>
<p>Generally, vehicles that reroute to a new parking area will continue to
their original destination after finishing the stop. In the special case
where</p>
<ol>
<li>the original route ended at the original parkingArea edge and</li>
<li>the arrivalPos was within [startPos, endPos] of the original
    parkingArea</li>
</ol>
<p>then the new route will also end at the new parkingArea and the endPos
of the new parkingArea will be set as new arrivalPos.</p>
<h3 id="traci_access_to_parkingsearch">TraCI access to parkingSearch<a class="headerlink" href="#traci_access_to_parkingsearch" title="Permanent link">#</a></h3>
<p>The current state of the parkingSearch can be accessed via calls to <code>traci.vehicle.getParameter</code> with the list permitted parameters given at <a href="../TraCI/Vehicle_Value_Retrieval.html#supported_further_parameters">TraCI/Vehicle_Value_Retrieval</a>.</p>
<h1 id="vehicle_behavior_when_closing_a_street">Vehicle Behavior when closing a street<a class="headerlink" href="#vehicle_behavior_when_closing_a_street" title="Permanent link">#</a></h1>
<p>The interaction of vehicles with reroutes is complex and depends on many
different factors. Below we give a description of each of the factors and then
describe the behavior for each combination of factors.
The following assumes vehicles that have an edge affected by <code>&lt;closingReroute .../&gt;</code>
along their route (other vehicles are not affected directly).</p>
<ol>
<li>closing style<ul>
<li>a) hard closing: <code>&lt;closingReroute&gt;</code> uses attribute 'allow' or 'disallow' to prohibit the vehicle</li>
<li>b) soft closing: attribute is not used (edge use is discouraged but not forbidden)</li>
</ul>
</li>
<li>alternatives<ul>
<li>a) an alternative route exists</li>
<li>b) no alternative route exists</li>
</ul>
</li>
<li>detour signage<ul>
<li>a) an rerouter edge is encountered before the alternative route branches off</li>
<li>b) no rerouter edge is encountered before the alternative route branches off</li>
</ul>
</li>
<li>vehicle style<ul>
<li>a) vehicle defined with origin and destination where the affected edge is on the preferred route (i.e. <code>&lt;trip from="..." to="..."&gt;</code>)</li>
<li>b) vehicle defined with fixed route</li>
</ul>
</li>
<li>closing time versus departure time<ul>
<li>a) vehicle departs after closing becomes active</li>
<li>b) vehicle departs before closing becomes active (closing occurs while en-route)</li>
</ul>
</li>
<li>routing mode of the vehicle (set via <strong>--device.rerouting.mode</strong> or vehicle/vtype <code>&lt;param key="device.rerouting.mode" value="8"/&gt;</code>)<ul>
<li>a) routing mode 0 (or generally, not setting the 4th bit): all hard closings are visible during routing</li>
<li>b) routing mode 8 (or generally setting the 4th bit): all hard-closings are ignored during routing and will never cause a route error</li>
</ul>
</li>
</ol>
<p>The following vehicle behaviors are possible:</p>
<ul>
<li><strong>R</strong>: use an alternative route upon reaching the rerouter edge</li>
<li><strong>D</strong>: use an alternative route on departure</li>
<li><strong>I</strong>: ignore the closed edge and keep driving</li>
<li><strong>W</strong>: wait ahead of the closed edge until it reopens or time-to-teleport is
  reached (in this case teleport across the closed edge(s))</li>
<li><strong>E</strong>: generate an error</li>
</ul>
<p>To following effects occur:</p>
<h2 id="hard_closing">Hard closing<a class="headerlink" href="#hard_closing" title="Permanent link">#</a></h2>
<ul>
<li>1a-2a-3a-4a-5a: <strong>D</strong></li>
<li>1a-2a-3a-4a-5b: <strong>R</strong></li>
<li>1a-2a-3a-4b-5a: <strong>R</strong></li>
<li>1a-2a-3a-4b-5b: <strong>R</strong></li>
</ul>
<ul>
<li>1a-2a-3b-4a-5a: <strong>D</strong></li>
<li>1a-2a-3b-4a-5b: <strong>W</strong></li>
<li>1a-2a-3b-4b-5a: <strong>W</strong></li>
<li>1a-2a-3b-4b-5b: <strong>W</strong></li>
</ul>
<ul>
<li>1a-2b-3a-4a-5a: <strong>E</strong> (becomes <strong>W</strong> with <strong>--ignore-route-errors</strong>)</li>
<li>1a-2b-3a-4a-5b: <strong>W</strong></li>
<li>1a-2b-3a-4b-5a: <strong>W</strong></li>
<li>1a-2b-3a-4b-5b: <strong>W</strong></li>
</ul>
<ul>
<li>1a-2b-3b-4a-5a: <strong>E</strong> (becomes <strong>W</strong> with <strong>--ignore-route-errors</strong>)</li>
<li>1a-2b-3b-4a-5b: <strong>W</strong></li>
<li>1a-2b-3b-4b-5a: <strong>W</strong></li>
<li>1a-2b-3b-4b-5b: <strong>W</strong></li>
</ul>
<h2 id="soft_closing">Soft closing<a class="headerlink" href="#soft_closing" title="Permanent link">#</a></h2>
<ul>
<li>1b-2a-3a-4a-5a: <strong>R</strong></li>
<li>1b-2a-3a-4a-5b: <strong>R</strong></li>
<li>1b-2a-3a-4b-5a: <strong>R</strong></li>
<li>1b-2a-3a-4b-5b: <strong>R</strong></li>
</ul>
<ul>
<li>1b-2a-3b-4a-5a: <strong>I</strong></li>
<li>1b-2a-3b-4a-5b: <strong>I</strong></li>
<li>1b-2a-3b-4b-5a: <strong>I</strong></li>
<li>1b-2a-3b-4b-5b: <strong>I</strong></li>
</ul>
<ul>
<li>1b-2b-3a-4a-5a: <strong>I</strong></li>
<li>1b-2b-3a-4a-5b: <strong>I</strong></li>
<li>1b-2b-3a-4b-5a: <strong>I</strong></li>
<li>1b-2b-3a-4b-5b: <strong>I</strong></li>
</ul>
<ul>
<li>1b-2b-3b-4a-5a: <strong>I</strong></li>
<li>1b-2b-3b-4a-5b: <strong>I</strong></li>
<li>1b-2b-3b-4b-5a: <strong>I</strong></li>
<li>1b-2b-3b-4b-5b: <strong>I</strong></li>
</ul>
<h2 id="departure_on_a_closed_edge">Departure on a closed edge<a class="headerlink" href="#departure_on_a_closed_edge" title="Permanent link">#</a></h2>
<p>When the departure edge for a vehicle is closed, vehicles will ignore this for
'soft' closing. For a 'hard' closing the simulation will raise an error. If <strong>--ignore-route-errors</strong> is set, the vehicle will be discarded with a warning.</p>
                </div>
          </div>
          <button onclick="goTopFunction()" id="goToTop" title="Go to top"><i class="fa-solid fa-arrow-up"></i></button>
        </div>

        <footer class="col-md-12">
          
            <br><small><i>This page was last edited on: 06 May 2024</i></small>
          
          <hr>
            <p>Copyright &copy; 2001-2024 German Aerospace Center (DLR) and others.</p>
          <p>Follow us on <a class="no-arrow-link" href="https://www.twitter.com/eclipsesumo/"><i class="fa-brands fa-x-twitter"></i></a> <a class="no-arrow-link" href="https://www.facebook.com/simulationofurbanmobility/"><i class="fa-brands fa-facebook"></i></a> <a class="no-arrow-link" href="https://www.instagram.com/eclipse.sumo/"><i class="fa-brands fa-instagram"></i></a>
          | Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a></p>
        </footer>

      <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body" style="color: #495057 !important;">
                <p>Enter your search terms:</p>
                <script async src="https://cse.google.com/cse.js?cx=004302551366764109984:1kpgtzrm6kv"></script>
                <div class="gcse-search"></div>
            </div>
        </div>
    </div>
</div>
      <script>
        window.onscroll = function() {scrollFunction()};

        function scrollFunction() {
          if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
            document.getElementById("goToTop").style.display = "block";
          } else {
            document.getElementById("goToTop").style.display = "none";
          }
        }

        function goTopFunction() {
          document.body.scrollTop = 0;
          document.documentElement.scrollTop = 0;
        }

        var base_url = "..",
            shortcuts = {"edit": 69, "help": 191, "search": 83};
        </script>
        <script src="../js/base.js" defer></script>

        <script>
          const toggleSwitch = document.querySelector('#theme-switch input[type="checkbox"]');

          function switchTheme(e) {
              if (e.target.checked) {
                  localStorage.setItem('sumo-docs-theme', 'dark');
                  document.documentElement.setAttribute('data-theme', 'dark');
                  toggleSwitch.checked = true;
              } else {
                  localStorage.setItem('sumo-docs-theme', 'light');
                  document.documentElement.setAttribute('data-theme', 'light');
                  toggleSwitch.checked = false;
              }
          }

          toggleSwitch.addEventListener('change', switchTheme, false);

          if (document.documentElement.getAttribute("data-theme") == "dark"){
              toggleSwitch.checked = true;
          }
          </script>

      <div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Key</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody style="color: #495057 !important;">
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help dialog</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search the Documentation</td>
                  </tr>
                  <tr>
                    <td class="edit shortcut"><kbd>e</kbd></td>
                    <td>Edit current page on GitHub</td>
                  </tr>
                </tbody>
              </table>
            </div>
        </div>
    </div>
</div>
    </body>
</html>