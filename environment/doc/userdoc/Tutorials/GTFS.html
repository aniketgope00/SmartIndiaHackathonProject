<!--
MkDocs version : 1.5.2
Build Date UTC : 07 May 2024 06:14:12
Last edit: 10 November 2023
-->
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <meta property="og:image" content="../images/image-facebook.jpg">
        <meta property="og:image:type" content="image/jpeg">
        <meta property="og:image:width" content="1080">
        <meta property="og:image:height" content="1080">

        
        
        <link rel="canonical" href="https://sumo.dlr.de/docs/Tutorials/GTFS.html">
        <link rel="shortcut icon" href="../images/favicon.ico">
        <title>GTFS - SUMO Documentation</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="apple-touch-icon" href="../images/apple-touch-icon.png">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../js/jquery-3.7.0.min.js" defer></script>
        <script src="../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 

      <script>
        // DARK MODE
        function detectColorScheme(){
          var theme="light";

          if(localStorage.getItem("sumo-docs-theme")){
              if(localStorage.getItem("sumo-docs-theme") == "dark"){
                  var theme = "dark";
              }
          } else if(!window.matchMedia) {
              return false;
          } else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
              var theme = "dark";
          }

          if (theme=="dark") {
              document.documentElement.setAttribute("data-theme", "dark");
          }
        }
        detectColorScheme();
      </script>

    </head>

    <body>

        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary text-center">
            <div class="container-fluid">
                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                </div>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../index.html" class="nav-link">Documentation</a>
                            </li>
                            <li class="navitem">
                                <a href="index.html" class="nav-link">Tutorials</a>
                            </li>
                            <li class="navitem">
                                <a href="../FAQ.html" class="nav-link">FAQ</a>
                            </li>
                            <li class="navitem">
                                <a href="../Downloads.html" class="nav-link">Downloads</a>
                            </li>
                            <li class="navitem">
                                <a href="../Publications.html" class="nav-link">Publications</a>
                            </li>
                            <li class="navitem">
                                <a href="../Developer/index.html" class="nav-link">Developer</a>
                            </li>
                            <li class="navitem">
                                <a href="../ChangeLog.html" class="nav-link">ChangeLog</a>
                            </li>
                            <li class="navitem">
                                <a href="https://eclipse.dev/sumo/contact/" class="nav-link">Contact</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa-solid fa-magnifying-glass"></i> <u>S</u>earch
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="edit" href="https://github.com/eclipse-sumo/sumo/edit/main/docs/web/docs/Tutorials/GTFS.md" class="nav-link"><i class="fa-brands fa-github"></i> <u>E</u>dit on GitHub</a>
                            </li>
                      <li class="nav-item dropdown">
                          <a class="nav-link dropdown-toggle" href="#" id="navbardrop" data-toggle="dropdown">
                            More <i class="fa-solid fa-circle-chevron-down"></i>
                          </a>
                          <div class="dropdown-menu dropdown-menu-right">
                            <a class="dropdown-item no-arrow-link" href="https://github.com/eclipse/sumo/issues">Report a Bug / Issue / Typo</a>
                            <a class="dropdown-item" href="../Editing_Articles.html">Help on editing articles</a>
                            <a class="dropdown-item" href="https://github.com/eclipse/sumo/commits/main/docs/web">Recent documentation changes</a>
                            <a class="dropdown-item" href="#" data-toggle="modal" data-target="#mkdocs_keyboard_modal">Keyboard Shortcuts</a>
                            <a class="dropdown-item no-arrow-link" href="https://sumo.dlr.de/sumo_documentation.zip">Download the Documentation</a>
                            <span class="dropdown-item" id="dark-mode-div">Dark mode <label id="theme-switch" class="theme-switch" for="checkbox_theme">
                              <input type="checkbox" id="checkbox_theme">
                          </label></span>
                          </div>
                        </li>
                        <li class="nav-item dropdown">
                          <a class="nav-link dropdown-toggle" href="#" id="languagedrop" data-toggle="dropdown">
                            <i class="fa-solid fa-language"></i> Languages <i class="fa-solid fa-circle-chevron-down"></i>
                          </a>
                          <div class="dropdown-menu dropdown-menu-right">
                            <span class="dropdown-item">
                              Translations are generated automatically by Google Translate:
                            </span>
                            <a class="dropdown-item" href="https://sumo-dlr-de.translate.goog/docs/Tutorials/GTFS.html?_x_tr_sl=en&_x_tr_tl=de">Deutsch</a>
                            <a class="dropdown-item" href="https://sumo-dlr-de.translate.goog/docs/Tutorials/GTFS.html?_x_tr_sl=en&_x_tr_tl=es">Español</a>
                            <a class="dropdown-item" href="https://sumo-dlr-de.translate.goog/docs/Tutorials/GTFS.html?_x_tr_sl=en&_x_tr_tl=fr">Français</a>
                            <a class="dropdown-item" href="https://sumo-dlr-de.translate.goog/docs/Tutorials/GTFS.html?_x_tr_sl=en&_x_tr_tl=it">Italiano</a>
                            <a class="dropdown-item" href="https://sumo-dlr-de.translate.goog/docs/Tutorials/GTFS.html?_x_tr_sl=en&_x_tr_tl=hu">Magyar</a>
                            <a class="dropdown-item" href="https://sumo-dlr-de.translate.goog/docs/Tutorials/GTFS.html?_x_tr_sl=en&_x_tr_tl=tr">Türkçe</a>
                          </div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container-fluid">
          <div class="row">
                <div class="col-md-3">
                  <div class="text-center"><a href="../index.html" style="display: inline-block; margin-top: 5px;"><img src="../images/sumo-logo.png" class="sumoLogo" alt="SUMO Logo" width="120px"></a></div>
                  
<div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Contents">
            <span class="fa-solid fa-angle-down"></span>
        </button>
    </div>
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary toc-scroll toc">
        <ul class="nav flex-column bs-sidenav">
            <p style="margin-top:5px; color:#777777;" class="text-center">Contents</p>
            <li class="nav-item main"><a href="#introduction">Introduction</a></li>
            <li class="nav-item main"><a href="#initial_network_requirements">Initial network requirements</a></li>
            <li class="nav-item main"><a href="#finding_a_data_source_for_gtfs">Finding a data source for GTFS</a></li>
            <li class="nav-item main"><a href="#mapping_gtfs_data_to_the_network">Mapping GTFS data to the network</a></li>
                <li class="nav-item" style="text-indent: 5px;">
                    <a href="#routes_from_shortest_path" class="nav-link">• Routes from shortest path</a>
                </li>
                <li class="nav-item" style="text-indent: 5px;">
                    <a href="#routes_from_osm" class="nav-link">• Routes from OSM</a>
                </li>
            <li class="nav-item main"><a href="#using_the_outputs_in_a_simulation">Using the outputs in a simulation</a></li>
        </ul>
    </div>

    <div class="admonition conference" style="position: sticky; margin-top: 20px; margin-bottom:10px;">
        <p>visit <a class="no-arrow-link" href="https://eclipse.dev/sumo">eclipse.dev/sumo</a></p>
    </div>

</div>
                </div>
                <div class="col-md-9 main-area" role="main">
                   <!-- page.is_homepage seems to be broken in Mkdocs > 1.1.0 -->
                  <ul class="breadcrumbs">
    <script>
        var pagePath = "/docs/Tutorials/GTFS.html";
        var splitUrl = pagePath.split("/");
        splitUrl.pop();
        splitUrl.shift();
        if (splitUrl[0] == 'docs') splitUrl.shift();
        var homeLink = "../index.html";
        document.write('<li class="breadcrumb-item"><a href="' + homeLink + '"><i class="fa-solid fa-house"></i></a></li>');
        var prev = '';

        var dirLink = splitUrl.map(function (el) {
        el = prev + el; prev = el + '/'; return el;
        });

        for (let i = 0; i < splitUrl.length; i++) {
            document.write("<li class=\"breadcrumb-item\"><a class=\"no-arrow-link\" href=\"../" + dirLink[i] + "\">" + splitUrl[i] + "</a></li>");
        }
    </script>
    <li class="breadcrumb-item active">GTFS</li>
</ul>
                  <hTitles>GTFS<hr style="border: 0.5px solid #338033; margin-top: 5px !important;"></hTitles>
                  
                  

<h1 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">#</a></h1>
<p>This tutorial shows you how to refine your existing public transit (PT) simulation
scenario with data in the <a href="https://developers.google.com/transit/gtfs">General Transit Specification Format</a> (GTFS)
which is available for many regions. It is advisable to do the
<a href="PT_from_OpenStreetMap.html">Public Transport Tutorial</a> first.</p>
<p>The creation of PT simulation consists of three steps:</p>
<ol>
<li>Initial network requirements</li>
<li>Finding a data source for GTFS</li>
<li>Mapping GTFS data to the network</li>
</ol>
<h1 id="initial_network_requirements">Initial network requirements<a class="headerlink" href="#initial_network_requirements" title="Permanent link">#</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Using the <a href="OSMWebWizard.html">osmWebWizard tool</a>, may be the easiest way to get a network but the process works with every (geo referenced) SUMO network.</p>
</div>
<p>The process works best with a network which comes from OpenStreetMap and also
has public transport lines data (see <a href="../Networks/Further_Outputs.html#public_transport_lines">ptLines output</a>).
The network should contain edges for all traffic types (modes) you want
to model and the relevant edge types. The script currently supports
the following mapping:</p>
<ul>
<li><code>tram</code> -&gt; all edges allowing SUMO's vehicle class tram</li>
<li><code>subway</code> -&gt; OSM type railway.subway</li>
<li><code>light_rail</code> -&gt; OSM type railway.light_rail</li>
<li><code>train</code> -&gt; OSM type railway.rail</li>
<li><code>bus</code> -&gt; all edges allowing SUMO's vehicle class bus</li>
<li><code>ship</code> -&gt; OSM type ship</li>
</ul>
<p>If the network does not contain edge types, only bus and tram mappings are possible which will use the edges
allowing the relevant vehicle classes.</p>
<p>For this tutorial we imported the network of Eichwalde with the osmWebWizard tool:</p>
<p><img src="../images/Eichwalde_net.png" alt="Eichwalde_net" width="600"></p>
<h1 id="finding_a_data_source_for_gtfs">Finding a data source for GTFS<a class="headerlink" href="#finding_a_data_source_for_gtfs" title="Permanent link">#</a></h1>
<p>There are <a href="https://transitfeeds.com/">several sources</a> for GTFS data usually on the website of your local
transit agency. <a href="https://gist.github.com/highsource/67d0846029a43ea28dfd90540bacb1ee">Some examples from Germany</a>:</p>
<ul>
<li><a href="https://gtfs.de/en/">Aggregated data for a lot of German regions</a></li>
<li><a href="https://www.vbb.de/vbb-services/api-open-data/datensaetze/">Berlin and Brandenburg (VBB)</a></li>
<li><a href="https://www.vbn.de/service/entwicklerinfos/">Lower Saxony and Bremen</a></li>
<li><a href="https://suche.transparenz.hamburg.de/?q=gtfs&amp;sort=score+desc%2Ctitle_sort+asc&amp;esq_not_all_versions=true">Hamburg</a></li>
</ul>
<p>This tutorial uses the <a href="https://sumo.dlr.de/daily/GTFS_VBB_Juni-Dezember-2019.zip">June 2019 dataset by VBB</a>.
You can either download the data or give the URL of the file directly to the script.</p>
<h1 id="mapping_gtfs_data_to_the_network">Mapping GTFS data to the network<a class="headerlink" href="#mapping_gtfs_data_to_the_network" title="Permanent link">#</a></h1>
<p>If you have all the data available you need to decide on the date you want to model. The script cannot find a representative date
by itself, you need to find one yourself. It is usually advisable to check the calendar for school (and other) holidays in advance.</p>
<p>For this tutorial we choose 04.09.2019 (a Wednesday).</p>
<p>Additionally, you can choose which public transport modes should be imported
(bus, tram, train, subway and/or ferry). By default, all modes will be imported. For
this tutorial we will only import buses.</p>
<p>Depending on the input files available, you can choose between different ways
of generating the routes. If you have the line and stop information extracted from OpenStreetMap
(using the appropriate netconvert options as described in <a href="../Networks/Further_Outputs.html#public_transport_lines">ptLines output</a>)
the script can merge this information with the GTFS data.</p>
<p>In general there are three types of data
we can extract from GTFS: schedules (in minute precision for every vehicle), stop locations (geo coordinates),
and routes (geo coordinates of the travelled streets), where the latter is optional. The GTFS file should be in
zip format and contain at least <code>routes.txt</code>, <code>stops.txt</code>, <code>stop_times.txt</code>, <code>trips.txt</code>, <code>calendar.txt</code> and <code>calendar_dates.txt</code>.
If your GTFS data has a (non-empty) <code>shapes.txt</code> file it also has route information.
For the rest of the tutorial, we will assume that you always want to import at least the schedules from GTFS.</p>
<p>From OSM you can (sometimes) get abstract schedules ("line runs every 10 minutes on weekdays") and also stop locations and routes.
While it may be desirable to choose for every of the three data types individually whether it should be imported from OSM
or from GTFS, currently, only the following scenarios are possible:</p>
<ul>
<li>Ignore the OSM and route data completely, see <a href="GTFS.html#routes_from_shortest_path">Routes from shortest path</a>.<ul>
<li>This approach works with every network (not only OSM) and is the default if you do not have ptline output or your GTFS does not contain a shapes.txt file</li>
</ul>
</li>
<li>Import <a href="GTFS.html#routes_from_osm">Routes from OSM</a>.<ul>
<li>This will try to find for every GTFS route the corresponding OSM route by using geometrical distance (stop information from OSM is not used)</li>
</ul>
</li>
</ul>
<h2 id="routes_from_shortest_path">Routes from shortest path<a class="headerlink" href="#routes_from_shortest_path" title="Permanent link">#</a></h2>
<p>In this case, the route for each public transport vehicle will be defined by
finding the fastest path between stops.</p>
<p>If you have downloaded the network and the GTFS data (or have the URL) it is as easy as</p>
<pre class="codehilite"><code>python tools/import/gtfs/gtfs2pt.py -n osm.net.xml --gtfs GTFS_VBB_Juni-Dezember-2019.zip --date 20190904 --modes bus --vtype-output pt_vtypes.xml
</code></pre>

<p>The script runs for about five minutes and generates several subdirectories but in the end it provides three output files:</p>
<ul>
<li><code>pt_vtypes.xml</code></li>
<li><code>gtfs_publictransport.add.xml</code> (defining the static routes and stops)</li>
<li><code>gtfs_publictransport.rou.xml</code> (defining the single public transport vehicles)</li>
</ul>
<p>The vtypes output generates very simple vehicle type definitions for the different public transport modes in use. You are encouraged to modify this file and adapt
it to the real situation especially concerning capacity (number of seats) for the different modes. You may of course also use vehicle types from another source and skip this output.</p>
<p>In order to use them in a simulation you should pass them as additional files (not route files!) in the order given above.</p>
<pre class="codehilite"><code>sumo-gui -n osm.net.xml --additional pt_vtypes.xml,gtfs_publictransport.add.xml,gtfs_publictransport.rou.xml
</code></pre>

<h2 id="routes_from_osm">Routes from OSM<a class="headerlink" href="#routes_from_osm" title="Permanent link">#</a></h2>
<p>In this case, the route for each vehicle is taken from OSM. When we imported the
net with the osmWebWizard tool, we enable the option of "import public transport",
which automatically generate the "osm_ptlines.xml" file with the public transport lines.</p>
<p>The call is:</p>
<pre class="codehilite"><code>python tools/import/gtfs/gtfs2pt.py -n osm.net.xml --gtfs GTFS_VBB_Juni-Dezember-2019.zip --date 20190904 --osm-routes osm_ptlines.xml --repair --modes bus
</code></pre>

<p>The option <strong>--repair</strong> is not mandatory, but helpful. It takes the given ptLines
and tries to repair them using duarouter before the mapping. If some routes of the
ptLines are not valid, they won't be used for the mapping.</p>
<p>The script generates four output files:</p>
<ul>
<li><code>gtfs_publictransport.add.xml</code> (defining the stops)</li>
<li><code>gtfs_publictransport.rou.xml</code> (defining the single public transport vehicles)</li>
<li><code>gtfs_missing.xml</code> contains the elements (stops and ptLines) of the GTFS data that could not be imported</li>
<li><code>invalid_osm_routes.txt</code> contains the warnings and errors from the repair of the ptLines</li>
</ul>
<p>To run the simulation call:</p>
<pre class="codehilite"><code>sumo-gui -n osm.net.xml --additional gtfs_publictransport.add.xml --routes gtfs_publictransport.rou.xml
</code></pre>

<h1 id="using_the_outputs_in_a_simulation">Using the outputs in a simulation<a class="headerlink" href="#using_the_outputs_in_a_simulation" title="Permanent link">#</a></h1>
<p>Below an example of using the mapped stops and buses in a simulation by calling sumo-gui:</p>
<p><img src="../images/tutorialGTFS.gif" alt="tutorialGTFS" width="600"></p>
                </div>
          </div>
          <button onclick="goTopFunction()" id="goToTop" title="Go to top"><i class="fa-solid fa-arrow-up"></i></button>
        </div>

        <footer class="col-md-12">
          
            <br><small><i>This page was last edited on: 10 November 2023</i></small>
          
          <hr>
            <p>Copyright &copy; 2001-2024 German Aerospace Center (DLR) and others.</p>
          <p>Follow us on <a class="no-arrow-link" href="https://www.twitter.com/eclipsesumo/"><i class="fa-brands fa-x-twitter"></i></a> <a class="no-arrow-link" href="https://www.facebook.com/simulationofurbanmobility/"><i class="fa-brands fa-facebook"></i></a> <a class="no-arrow-link" href="https://www.instagram.com/eclipse.sumo/"><i class="fa-brands fa-instagram"></i></a>
          | Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a></p>
        </footer>

      <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body" style="color: #495057 !important;">
                <p>Enter your search terms:</p>
                <script async src="https://cse.google.com/cse.js?cx=004302551366764109984:1kpgtzrm6kv"></script>
                <div class="gcse-search"></div>
            </div>
        </div>
    </div>
</div>
      <script>
        window.onscroll = function() {scrollFunction()};

        function scrollFunction() {
          if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
            document.getElementById("goToTop").style.display = "block";
          } else {
            document.getElementById("goToTop").style.display = "none";
          }
        }

        function goTopFunction() {
          document.body.scrollTop = 0;
          document.documentElement.scrollTop = 0;
        }

        var base_url = "..",
            shortcuts = {"edit": 69, "help": 191, "search": 83};
        </script>
        <script src="../js/base.js" defer></script>

        <script>
          const toggleSwitch = document.querySelector('#theme-switch input[type="checkbox"]');

          function switchTheme(e) {
              if (e.target.checked) {
                  localStorage.setItem('sumo-docs-theme', 'dark');
                  document.documentElement.setAttribute('data-theme', 'dark');
                  toggleSwitch.checked = true;
              } else {
                  localStorage.setItem('sumo-docs-theme', 'light');
                  document.documentElement.setAttribute('data-theme', 'light');
                  toggleSwitch.checked = false;
              }
          }

          toggleSwitch.addEventListener('change', switchTheme, false);

          if (document.documentElement.getAttribute("data-theme") == "dark"){
              toggleSwitch.checked = true;
          }
          </script>

      <div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Key</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody style="color: #495057 !important;">
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help dialog</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search the Documentation</td>
                  </tr>
                  <tr>
                    <td class="edit shortcut"><kbd>e</kbd></td>
                    <td>Edit current page on GitHub</td>
                  </tr>
                </tbody>
              </table>
            </div>
        </div>
    </div>
</div>
    </body>
</html>